<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		<link rel="stylesheet" href="css/login.css" />
		<title>注册 | 怪兽电影</title>
	</head>

	<body class="pg-unitive-signup theme--maoyan">

		<!-- 顶部logo -->
		<header class="header--mini">
			<div style="border-bottom: 2px solid #CC0000;height: 70px;">
				<img src="img/logo.png" style="width: 200px; height:auto;margin-left: 400px;"/>
			</div>
		</header>

		<div class="content" style="margin-left: 500px;margin-top:30px;">
			<div class="J-unitive-signup-form">

				<div class="sheet" style="display:block">
					<!-- 注册表单 -->
					<form id="registerForm" method="POST">

						<!-- 注册失败提示框 -->
						<div class="validate-info" style="display:none;">
							<i class="tip-status tip-status--opinfo"></i>
							<span id="errorTips"></span>
						</div>

						<!-- 用户名框 -->
						<div class="form-field form-field--mobile">
							<label>用户名</label>
							<input type="text" name="customerName" class="f-text J-mobile">
						</div>
						<!-- 账号框 -->
						<div class="form-field form-field--mobile">
							<label>账号</label>
							<input type="text" name="customerAccounts" class="f-text J-mobile">
						</div>
						<!-- 创建密码框 -->
						<div class="form-field form-field--pwd">
							<label>密码</label>
							<input type="password" name="customerPassword" class="f-text J-pwd">
						</div>
						<!-- 确认密码框 -->
						<div class="form-field form-field--pwd2">
							<label>确认密码</label>
							<input type="password" class="f-text J-pwd2" id="confirmPassword">
						</div>
						<!-- 注册按钮 -->
						<div class="form-field">
							<input type="button" class="btn" value="注册" style="width: 260px;" onclick="start()">
						</div>
					</form>
				</div>
			</div>
		</div>

		<div style="width: auto;border-bottom: 1px solid #EEEEEE;margin-top: 20px;margin-bottom: 20px;"></div>
		
		<footer class="footer">
			<div class="copyright">
				<p>
					©<span>2020</span>
					<a href="javascript:void(0)">怪兽电影</a>
					mostermovie.com
				</p>
			</div>
		</footer>

		<script src="js/jquery-1.12.4.min.js"></script>
		<script>
			function start() {
				if($("#confirmPassword").val()==$("input[name='customerPassword']").val()){
					$(".validate-info").css("display","none");
					register();
				}else{
					$(".validate-info").css("display","block");
					$("#errorTips").text("两次密码不一致");
				}
			}
			function register() {
				var form = $("#registerForm").serialize();
				$.ajax({
					url : 'register',
					method : 'post',
					data : form,
					success : function(result){
						if(result.code == 200){
							// $(".validate-info").css("display","none");
							// alert("注册成功");
							// location.href="login.html";
							addUserRole();
						}else {
							alert(result.message);
							$(".validate-info").css("display","block");
							$("#errorTips").text(result.message);
						}
					}
				});
			}
			function addUserRole() {
				var accounts = $("input[name='customerAccounts']").val();
				$.ajax({
					url : 'addCustomerUserRole',
					method : 'post',
					data : "customerAccounts="+accounts,
					success : function(result){
						if(result.code == 200){
							alert("注册成功");
						}
					}
				});
			}
		</script>
	</body>
</html>
